<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Notes</title>
</head>
<body>
    <h1>Voice Notes</h1>
    <button id="start-recording">Start Recording</button>
    <button id="stop-recording" disabled>Stop Recording</button>
    <p id="status">Status: Not recording</p>
    <button id="send-to-salesforce" disabled>Send to Salesforce</button>

    <script>
        let recognition;
        let audioBlob;
        let recording = false;

        if (!('webkitSpeechRecognition' in window)) {
            alert('Your browser does not support the Web Speech API');
        } else {
            recognition = new webkitSpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;

            recognition.onstart = function() {
                recording = true;
                document.getElementById('status').innerText = 'Status: Recording...';
                document.getElementById('stop-recording').disabled = false;
                document.getElementById('start-recording').disabled = true;
                document.getElementById('send-to-salesforce').disabled = true;
            };

            recognition.onresult = function(event) {
                audioBlob = event.results[0][0].transcript;
                document.getElementById('status').innerText = 'Status: Recording finished';
                document.getElementById('send-to-salesforce').disabled = false;
            };

            recognition.onerror = function(event) {
                document.getElementById('status').innerText = 'Status: Error during recording';
                recording = false;
                document.getElementById('start-recording').disabled = false;
                document.getElementById('stop-recording').disabled = true;
            };

            document.getElementById('start-recording').onclick = function() {
                recognition.start();
            };

            document.getElementById('stop-recording').onclick = function() {
                recognition.stop();
                recording = false;
                document.getElementById('start-recording').disabled = false;
                document.getElementById('stop-recording').disabled = true;
            };

            document.getElementById('send-to-salesforce').onclick = function() {
                sendToSalesforce(audioBlob);
            };

            function sendToSalesforce(note) {
                fetch('https://anderlineigwe6-dev-ed.develop.my.salesforce.com/services/data/v58.0/sobjects/Voice_Note__c', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer 00Dd2000001tYi3!AQEAQAQD_XGeOISrNM8iSMzVQMcXg0sH3HOFpGpyOpp3PjHFnITMfnQl5taAekfh1CVIJ1Okq3bvvoI1xreWN5wVoQbFoF_j',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        Notes__c: note
                    })
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    alert('Note sent to Salesforce successfully!');
                })
                .catch((error) => {
                    console.error('Error:', error);
                    alert('Error sending note to Salesforce');
                });
            }
        }
    </script>
</body>
</html>
